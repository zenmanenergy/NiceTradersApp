import{f as _,a as c,c as Le,t as re}from"../chunks/Cunh0d-7.js";import{i as we}from"../chunks/oo_yk0cj.js";import{al as xe,an as o,ap as r,i as e,t as S,ao as l,am as _e,aj as ve,a4 as P,ak as z,W as v,at as w,as as me}from"../chunks/BDZjGMj5.js";import{e as I,s as B}from"../chunks/klik1TuH.js";import{i as b}from"../chunks/Ko-oeFjF.js";import{r as Q}from"../chunks/D7v9Epbb.js";import{S as Ee,b as Re,s as V,c as X}from"../chunks/vbtHKNFL.js";import{g as he}from"../chunks/SwMl67WK.js";import{p as ge}from"../chunks/Dg2lMkti.js";function fe(j){return function(...T){var u=T[0];return u.preventDefault(),j?.apply(this,T)}}async function Fe(j,T,u,d){console.log("handleLogin",j,T,u);const C={Email:j,Password:T},L=Re+"/Login/Login?";let f=await Ee(L,C,u);return f===!1?(d(!1),!1):(f&&f.SessionId&&f.UserType?(console.log("Login successful, SessionId:",f.SessionId,"UserType:",f.UserType),Cookies.set("SessionId",f.SessionId,{expires:365}),Cookies.set("UserType",f.UserType,{expires:365}),d(!0),window.location.href="/dashboard"):(console.error("Invalid login response, no SessionId or UserType received"),Cookies.remove("SessionId"),Cookies.remove("UserType"),d(!1)),!0)}const Ue=typeof window<"u"&&(window.location.hostname==="127.0.0.1"||window.location.hostname==="localhost")?"http://127.0.0.1:9000":"https://api.nicetraders.net",be={baseURL:Ue};var Be=_('<div class="error-message svelte-1h1khof"> </div>'),Ie=_('<span class="error-text svelte-1h1khof"> </span>'),je=_(`<h2 class="svelte-1h1khof">Reset Your Password</h2> <p class="subtitle svelte-1h1khof">Enter your email address and we'll send you a reset code</p> <!> <form><div class="form-group svelte-1h1khof"><label for="reset-email" class="svelte-1h1khof">Email Address</label> <input type="email" id="reset-email" placeholder="Enter your email"/> <!></div> <button type="submit" class="submit-button svelte-1h1khof"><!></button></form> <button class="back-button svelte-1h1khof">Back to Login</button>`,1),qe=_('<div class="success-message svelte-1h1khof"> </div>'),Me=_('<div class="error-message svelte-1h1khof"> </div>'),De=_('<span class="error-text svelte-1h1khof"> </span>'),Oe=_('<span class="error-text svelte-1h1khof"> </span>'),Ae=_('<span class="error-text svelte-1h1khof"> </span>'),He=_('<h2 class="svelte-1h1khof">Reset Your Password</h2> <!> <!> <form><div class="form-group svelte-1h1khof"><label for="reset-token" class="svelte-1h1khof">Reset Code</label> <input type="text" id="reset-token" placeholder="Enter the code from your email"/> <!></div> <div class="form-group svelte-1h1khof"><label for="new-password" class="svelte-1h1khof">New Password</label> <input type="password" id="new-password" placeholder="Enter new password (min 6 characters)"/> <!></div> <div class="form-group svelte-1h1khof"><label for="confirm-password" class="svelte-1h1khof">Confirm Password</label> <input type="password" id="confirm-password" placeholder="Confirm your password"/> <!></div> <button type="submit" class="submit-button svelte-1h1khof"><!></button></form> <button class="back-button svelte-1h1khof">Back</button>',1),Ne=_('<div class="forgot-password-modal svelte-1h1khof"><div class="modal-content svelte-1h1khof"><button class="close-button svelte-1h1khof">Ã—</button> <!></div></div>');function Je(j,T){xe(T,!1);let u=ge(T,"onClose",8,()=>{}),d=ge(T,"onBackToLogin",8,()=>{}),C=S("email"),L=S(""),f=S(""),q=S(""),Z=S(""),s=S({}),D=S(""),g=S(!1);function oe(){return v(s,{}),e(L).trim()?/\S+@\S+\.\S+/.test(e(L))?!0:(w(s,e(s).email="Please enter a valid email"),!1):(w(s,e(s).email="Email is required"),!1)}function le(){return v(s,{}),e(f).trim()?e(q)?e(q).length<6?(w(s,e(s).newPassword="Password must be at least 6 characters"),!1):e(q)!==e(Z)?(w(s,e(s).confirmPassword="Passwords do not match"),!1):!0:(w(s,e(s).newPassword="Password is required"),!1):(w(s,e(s).resetToken="Reset code is required"),!1)}async function de(){if(oe()){v(g,!0),v(D,""),v(s,{});try{const h=await(await fetch(`${be.baseURL}/Login/ForgotPassword`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(L)})})).json();h.success?(v(D,h.message||"Check your email for reset instructions"),v(C,"reset"),h.resetToken&&v(f,h.resetToken)):w(s,e(s).general=h.error||"Failed to process request")}catch(p){w(s,e(s).general="Error connecting to server: "+p.message)}finally{v(g,!1)}}}async function ie(){if(le()){v(g,!0);try{const h=await(await fetch(`${be.baseURL}/Login/ResetPassword`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(f),newPassword:e(q)})})).json();h.success?(v(D,"Password reset successful! Redirecting to login..."),setTimeout(()=>{d()()},2e3)):w(s,e(s).general=h.error||"Failed to reset password")}catch(p){w(s,e(s).general="Error connecting to server: "+p.message)}finally{v(g,!1)}}}we();var O=Ne(),ne=o(O),$=o(ne),N=r($,2);{var ee=p=>{var h=je(),W=r(ve(h),4);{var A=i=>{var m=Be(),t=o(m,!0);l(m),z(()=>B(t,(e(s),P(()=>e(s).general)))),c(i,m)};b(W,i=>{e(s),P(()=>e(s).general)&&i(A)})}var k=r(W,2),R=o(k),E=r(o(R),2);Q(E);let Y;var M=r(E,2);{var se=i=>{var m=Ie(),t=o(m,!0);l(m),z(()=>B(t,(e(s),P(()=>e(s).email)))),c(i,m)};b(M,i=>{e(s),P(()=>e(s).email)&&i(se)})}l(R);var y=r(R,2),H=o(y);{var F=i=>{var m=re("Sending...");c(i,m)},G=i=>{var m=re("Send Reset Code");c(i,m)};b(H,i=>{e(g)?i(F):i(G,!1)})}l(y),l(k);var K=r(k,2);z(()=>{E.disabled=e(g),Y=V(E,1,"svelte-1h1khof",null,Y,{error:e(s).email}),y.disabled=e(g)}),X(E,()=>e(L),i=>v(L,i)),I("submit",k,fe(de)),I("click",K,function(...i){d()?.apply(this,i)}),c(p,h)},J=p=>{var h=Le(),W=ve(h);{var A=k=>{var R=He(),E=r(ve(R),2);{var Y=a=>{var n=qe(),U=o(n,!0);l(n),z(()=>B(U,e(D))),c(a,n)};b(E,a=>{e(D)&&a(Y)})}var M=r(E,2);{var se=a=>{var n=Me(),U=o(n,!0);l(n),z(()=>B(U,(e(s),P(()=>e(s).general)))),c(a,n)};b(M,a=>{e(s),P(()=>e(s).general)&&a(se)})}var y=r(M,2),H=o(y),F=r(o(H),2);Q(F);let G;var K=r(F,2);{var i=a=>{var n=De(),U=o(n,!0);l(n),z(()=>B(U,(e(s),P(()=>e(s).resetToken)))),c(a,n)};b(K,a=>{e(s),P(()=>e(s).resetToken)&&a(i)})}l(H);var m=r(H,2),t=r(o(m),2);Q(t);let x;var te=r(t,2);{var ke=a=>{var n=Oe(),U=o(n,!0);l(n),z(()=>B(U,(e(s),P(()=>e(s).newPassword)))),c(a,n)};b(te,a=>{e(s),P(()=>e(s).newPassword)&&a(ke)})}l(m);var ce=r(m,2),ae=r(o(ce),2);Q(ae);let pe;var ye=r(ae,2);{var Pe=a=>{var n=Ae(),U=o(n,!0);l(n),z(()=>B(U,(e(s),P(()=>e(s).confirmPassword)))),c(a,n)};b(ye,a=>{e(s),P(()=>e(s).confirmPassword)&&a(Pe)})}l(ce);var ue=r(ce,2),ze=o(ue);{var Se=a=>{var n=re("Resetting...");c(a,n)},Te=a=>{var n=re("Reset Password");c(a,n)};b(ze,a=>{e(g)?a(Se):a(Te,!1)})}l(ue),l(y);var Ce=r(y,2);z(()=>{F.disabled=e(g),G=V(F,1,"svelte-1h1khof",null,G,{error:e(s).resetToken}),t.disabled=e(g),x=V(t,1,"svelte-1h1khof",null,x,{error:e(s).newPassword}),ae.disabled=e(g),pe=V(ae,1,"svelte-1h1khof",null,pe,{error:e(s).confirmPassword}),ue.disabled=e(g)}),X(F,()=>e(f),a=>v(f,a)),X(t,()=>e(q),a=>v(q,a)),X(ae,()=>e(Z),a=>v(Z,a)),I("submit",y,fe(ie)),I("click",Ce,()=>{v(C,"email"),v(s,{})}),c(k,R)};b(W,k=>{e(C)==="reset"&&k(A)},!0)}c(p,h)};b(N,p=>{e(C)==="email"?p(ee):p(J,!1)})}l(ne),l(O),I("click",$,function(...p){u()?.apply(this,p)}),c(j,O),_e()}var We=_('<span class="error-message svelte-1x05zx6"> </span>'),Ye=_('<span class="error-message svelte-1x05zx6"> </span>'),Ge=_('<span class="loading-spinner svelte-1x05zx6"></span> Signing In...',1),Ke=_(`<!> <main class="login-container svelte-1x05zx6"><div class="header svelte-1x05zx6"><button class="back-button svelte-1x05zx6"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15,18 9,12 15,6"></polyline></svg></button> <h1 class="page-title svelte-1x05zx6">Sign In</h1> <div class="spacer svelte-1x05zx6"></div></div> <div class="content svelte-1x05zx6"><div class="welcome-text svelte-1x05zx6"><h2 class="welcome-title svelte-1x05zx6">Welcome Back</h2></div> <form class="login-form svelte-1x05zx6"><div class="form-group svelte-1x05zx6"><label for="email" class="form-label svelte-1x05zx6">Email Address</label> <input type="email" id="email" placeholder="Enter your email" autocomplete="email"/> <!></div> <div class="form-group svelte-1x05zx6"><label for="password" class="form-label svelte-1x05zx6">Password</label> <input type="password" id="password" placeholder="Enter your password" autocomplete="current-password"/> <!></div> <div class="form-options svelte-1x05zx6"><button type="button" class="forgot-link svelte-1x05zx6">Forgot Password?</button></div> <button type="submit" class="submit-button svelte-1x05zx6"><!></button></form> <div class="divider svelte-1x05zx6"><span class="divider-text svelte-1x05zx6">or</span></div> <div class="social-login svelte-1x05zx6"><button class="social-button svelte-1x05zx6"><svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg> Continue with Google</button></div> <div class="signup-link svelte-1x05zx6"><p class="svelte-1x05zx6">Don't have an account? <button type="button" class="link-button svelte-1x05zx6">Sign Up</button></p></div></div></main>`,1);function rs(j,T){xe(T,!1);let u=S({email:"",password:""}),d=S({}),C=S(!1),L=S(!1);function f(){return v(d,{}),e(u).email.trim()?/\S+@\S+\.\S+/.test(e(u).email)||w(d,e(d).email="Please enter a valid email"):w(d,e(d).email="Email is required"),e(u).password||w(d,e(d).password="Password is required"),Object.keys(e(d)).length===0}async function q(){f()&&(v(C,!0),await Fe(e(u).email,e(u).password,f(),t=>{v(C,!1),console.log(t?"Login successful":"Login failed")}))}function Z(){he("/")}function s(){he("/signup")}function D(){v(L,!0)}function g(){v(L,!1)}we();var oe=Ke(),le=ve(oe);{var de=t=>{Je(t,{onClose:g,onBackToLogin:g})};b(le,t=>{e(L)&&t(de)})}var ie=r(le,2),O=o(ie),ne=o(O);me(4),l(O);var $=r(O,2),N=r(o($),2),ee=o(N),J=r(o(ee),2);Q(J);let p;var h=r(J,2);{var W=t=>{var x=We(),te=o(x,!0);l(x),z(()=>B(te,e(d).email)),c(t,x)};b(h,t=>{e(d).email&&t(W)})}l(ee);var A=r(ee,2),k=r(o(A),2);Q(k);let R;var E=r(k,2);{var Y=t=>{var x=Ye(),te=o(x,!0);l(x),z(()=>B(te,e(d).password)),c(t,x)};b(E,t=>{e(d).password&&t(Y)})}l(A);var M=r(A,2),se=o(M);l(M);var y=r(M,2),H=o(y);{var F=t=>{var x=Ge();me(),c(t,x)},G=t=>{var x=re("Sign In");c(t,x)};b(H,t=>{e(C)?t(F):t(G,!1)})}l(y),l(N);var K=r(N,6),i=o(K),m=r(o(i));l(i),l(K),l($),l(ie),z(()=>{p=V(J,1,"form-input svelte-1x05zx6",null,p,{error:e(d).email}),R=V(k,1,"form-input svelte-1x05zx6",null,R,{error:e(d).password}),y.disabled=e(C)}),I("click",ne,Z),X(J,()=>e(u).email,t=>w(u,e(u).email=t)),X(k,()=>e(u).password,t=>w(u,e(u).password=t)),I("click",se,D),I("submit",N,fe(q)),I("click",m,s),c(j,oe),_e()}export{rs as component};

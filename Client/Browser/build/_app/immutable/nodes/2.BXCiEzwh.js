import{f as _,a as o,c as Ee,t as vs}from"../chunks/Cunh0d-7.js";import{i as ls}from"../chunks/oo_yk0cj.js";import{h as Ms,f as Bs,aA as Fs,o as Ss,aq as Vs,aD as Is,w as Cs,a$ as Os,b0 as Gs,T as qs,al as os,am as ns,an as a,ap as s,ao as t,aj as $e,ak as S,i as e,a4 as i,as as is,ag as ts,b1 as ks,b2 as Us,t as le,W as k,au as Ds,at as as,b3 as ms}from"../chunks/BDZjGMj5.js";import{i as j}from"../chunks/Ko-oeFjF.js";import{s as _s,a as gs,b as ys,c as As,p as Ts}from"../chunks/Dg2lMkti.js";import{e as Xe,i as Ze}from"../chunks/Dl_Jj4LQ.js";import{e as Y,s as v}from"../chunks/klik1TuH.js";import{w as ws}from"../chunks/CCdr6XA7.js";import{r as Ye,s as zs,a as Ws}from"../chunks/D7v9Epbb.js";import{s as Ie,S as Re,c as Qe,a as Hs}from"../chunks/vbtHKNFL.js";function Js(T,W,r,Z,ee){Ms&&Bs();var N=W.$$slots?.[r],g=!1;N===!0&&(N=W.children,g=!0),N===void 0||N(T,g?()=>Z:Z)}function Rs(T,W,r=!1){if(T.multiple){if(W==null)return;if(!Cs(W))return Os();for(var Z of T.options)Z.selected=W.includes(js(Z));return}for(Z of T.options){var ee=js(Z);if(Gs(ee,W)){Z.selected=!0;return}}(!r||W!==void 0)&&(T.selectedIndex=-1)}function Ks(T){var W=new MutationObserver(()=>{Rs(T,T.__value)});W.observe(T,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),qs(()=>{W.disconnect()})}function hs(T,W,r=W){var Z=new WeakSet,ee=!0;Fs(T,"change",N=>{var g=N?"[selected]":":checked",f;if(T.multiple)f=[].map.call(T.querySelectorAll(g),js);else{var w=T.querySelector(g)??T.querySelector("option:not([disabled])");f=w&&js(w)}r(f),Ss!==null&&Z.add(Ss)}),Vs(()=>{var N=W();if(T===document.activeElement){var g=Is??Ss;if(Z.has(g))return}if(Rs(T,N,ee),ee&&N===void 0){var f=T.querySelector(":checked");f!==null&&(N=js(f),r(N))}T.__value=N,ee=!1}),Ks(T)}function js(T){return"__value"in T?T.__value:T.value}const fs=ws({searchType:"users",searchTerm:"",searchResults:[],loading:!1,error:null}),Ne=ws({currentView:"search",breadcrumbs:[]}),$s=ws({currentUser:null,userListings:[],userPurchases:[],userMessages:[],userRatings:[],userDevices:[]}),Ns=ws({currentListing:null,listingPurchases:[],listingMessages:[],listingOwner:null}),Ps=ws({currentTransaction:null,transactionBuyer:null,transactionSeller:null,transactionListing:null});var Ys=_('<span class="breadcrumb-separator svelte-absptv">â€º</span> <span class="breadcrumb-item svelte-absptv"> </span>',1),Qs=_('<div class="breadcrumb-nav svelte-absptv"><button class="breadcrumb-btn svelte-absptv">ğŸ  Home</button> <!> <button class="back-btn svelte-absptv">â† Back</button></div>'),Xs=_('<main class="admin-container svelte-absptv"><div class="admin-header svelte-absptv"><div class="header-content svelte-absptv"><div><h1 class="svelte-absptv">ğŸ”§ Admin Dashboard</h1> <p class="svelte-absptv">Nice Traders Admin</p></div> <div class="header-buttons svelte-absptv"><button class="logs-btn svelte-absptv">ğŸ’³ Payment Reports</button> <button class="logs-btn svelte-absptv">ğŸ“‹ View Logs</button></div></div></div> <!> <!></main>');function Zs(T,W){os(W,!1);const r=()=>gs(Ne,"$viewState",Z),[Z,ee]=_s();function N(){ys(Ne,{currentView:"search",breadcrumbs:[]})}function g(){ys(Ne,{currentView:"logs",breadcrumbs:[]})}function f(){ys(Ne,{currentView:"payment-reports",breadcrumbs:[]})}function w(){r().breadcrumbs.length>0?(r().breadcrumbs.pop(),r().breadcrumbs.length===0?As(Ne,i(r).currentView="search",i(r)):r().breadcrumbs[r().breadcrumbs.length-1],ys(Ne,r())):(As(Ne,i(r).currentView="search",i(r)),ys(Ne,r()))}ls();var I=Xs(),x=a(I),z=a(x),m=s(a(z),2),C=a(m),O=s(C,2);t(m),t(z),t(x);var B=s(x,2);{var ae=P=>{var A=Qs(),Q=a(A),ve=s(Q,2);Xe(ve,1,()=>r().breadcrumbs,Ze,(ge,U)=>{var G=Ys(),ue=s($e(G),2),_e=a(ue,!0);t(ue),S(()=>v(_e,e(U).label)),o(ge,G)});var ye=s(ve,2);t(A),Y("click",Q,N),Y("click",ye,w),o(P,A)};j(B,P=>{r().breadcrumbs&&r().breadcrumbs.length>0&&P(ae)})}var se=s(B,2);Js(se,W,"default",{}),t(I),Y("click",C,f),Y("click",O,g),o(T,I),ns(),ee()}function Le(T){return T?new Date(T).toLocaleString():"-"}function He(T,W="USD"){return T==null?"-":`${W} ${parseFloat(T).toFixed(2)}`}var et=_('<div class="loading svelte-1ppid2h">Searching...</div>'),st=_('<div class="error svelte-1ppid2h"> </div>'),tt=_('<div class="result-card svelte-1ppid2h"><div class="result-icon svelte-1ppid2h">ğŸ‘¤</div> <div class="result-info svelte-1ppid2h"><h4 class="svelte-1ppid2h"> </h4> <p class="svelte-1ppid2h"> </p> <small class="svelte-1ppid2h"> </small></div> <div class="result-arrow svelte-1ppid2h">â†’</div></div>'),at=_('<div class="result-card svelte-1ppid2h"><div class="result-icon svelte-1ppid2h">ğŸ’±</div> <div class="result-info svelte-1ppid2h"><h4 class="svelte-1ppid2h"> </h4> <p class="svelte-1ppid2h"> </p> <small class="svelte-1ppid2h"> </small></div> <div class="result-arrow svelte-1ppid2h">â†’</div></div>'),rt=_('<div class="result-card svelte-1ppid2h"><div class="result-icon svelte-1ppid2h">ğŸ’°</div> <div class="result-info svelte-1ppid2h"><h4 class="svelte-1ppid2h"> </h4> <p class="svelte-1ppid2h"> </p> <small class="svelte-1ppid2h"> </small></div> <div class="result-arrow svelte-1ppid2h">â†’</div></div>'),vt=_('<div class="results-container svelte-1ppid2h"><h3 class="svelte-1ppid2h"> </h3> <div class="results-list svelte-1ppid2h"></div></div>'),it=_('<div class="search-container svelte-1ppid2h"><div class="search-type-selector svelte-1ppid2h"><button>ğŸ‘¤ Users</button> <button>ğŸ“§ Email</button> <button>ğŸ’± Listings</button> <button>ğŸ’° Transactions</button></div> <div class="search-box svelte-1ppid2h"><input type="text" class="search-input svelte-1ppid2h"/> <button class="search-btn svelte-1ppid2h">Search</button></div> <!></div>');function lt(T,W){os(W,!1);const r=()=>gs(fs,"$searchState",Z),[Z,ee]=_s();let N=Ts(W,"viewUser",8),g=Ts(W,"viewListing",8),f=Ts(W,"viewTransaction",8);async function w(){if(r().searchTerm.trim()){fs.update(U=>({...U,loading:!0,error:null,searchResults:[]}));try{let U="",G={search:r().searchTerm};switch(r().searchType){case"users":U="/Admin/SearchUsers";break;case"listings":U="/Admin/SearchListings";break;case"transactions":U="/Admin/SearchTransactions";break;case"email":U="/Admin/SearchUsers",G.email=r().searchTerm;break}const ue=await Re(U,G);fs.update(_e=>({..._e,searchResults:ue.success?ue.data||[]:[],error:ue.success?null:ue.error||"Search failed",loading:!1}))}catch(U){fs.update(G=>({...G,error:U.message,loading:!1}))}}}function I(U){fs.update(G=>({...G,searchType:U}))}function x(U){fs.update(G=>({...G,searchTerm:U}))}function z(U){U.key==="Enter"&&w()}ls();var m=it(),C=a(m),O=a(C),B=s(O,2),ae=s(B,2),se=s(ae,2);t(C);var P=s(C,2),A=a(P);Ye(A);var Q=s(A,2);t(P);var ve=s(P,2);{var ye=U=>{var G=et();o(U,G)},ge=U=>{var G=Ee(),ue=$e(G);{var _e=oe=>{var pe=st(),me=a(pe);t(pe),S(()=>v(me,`Error: ${r(),i(()=>r().error)??""}`)),o(oe,pe)},je=oe=>{var pe=Ee(),me=$e(pe);{var Se=ke=>{var ne=vt(),he=a(ne),Me=a(he);t(he);var Ae=s(he,2);Xe(Ae,5,()=>(r(),i(()=>r().searchResults)),Ze,(Pe,d)=>{var re=Ee(),fe=$e(re);{var Te=be=>{var $=tt(),L=s(a($),2),V=a(L),n=a(V);t(V);var b=s(V,2),R=a(b,!0);t(b);var M=s(b,2),p=a(M);t(M),t(L),is(2),t($),S(u=>{v(n,`${e(d),i(()=>e(d).FirstName)??""} ${e(d),i(()=>e(d).LastName)??""}`),v(R,(e(d),i(()=>e(d).Email))),v(p,`Joined: ${u??""}`)},[()=>(ts(Le),e(d),i(()=>Le(e(d).DateCreated)))]),Y("click",$,()=>N()(e(d).user_id,`${e(d).FirstName} ${e(d).LastName}`)),o(be,$)},Ue=be=>{var $=Ee(),L=$e($);{var V=b=>{var R=at(),M=s(a(R),2),p=a(M),u=a(p);t(p);var D=s(p,2),l=a(D,!0);t(D);var E=s(D,2),c=a(E,!0);t(E),t(M),is(2),t(R),S(y=>{v(u,`${e(d),i(()=>e(d).currency)??""} â†’ ${e(d),i(()=>e(d).accept_currency)??""}`),v(l,y),v(c,(e(d),i(()=>e(d).location)))},[()=>(ts(He),e(d),i(()=>He(e(d).amount,e(d).currency)))]),Y("click",R,()=>g()(e(d).listing_id,`${e(d).currency} â†’ ${e(d).accept_currency}`)),o(b,R)},n=b=>{var R=Ee(),M=$e(R);{var p=u=>{var D=rt(),l=s(a(D),2),E=a(l),c=a(E);t(E);var y=s(E,2),H=a(y);t(y);var J=s(y,2),te=a(J,!0);t(J),t(l),is(2),t(D),S((K,X)=>{v(c,`Purchase: ${K??""}`),v(H,`Payment: ${e(d),i(()=>e(d).payment_method)??""}`),v(te,X)},[()=>(ts(He),e(d),i(()=>He(e(d).amount_paid,e(d).currency))),()=>(ts(Le),e(d),i(()=>Le(e(d).purchased_at)))]),Y("click",D,()=>f()(e(d).access_id,`Purchase ${e(d).access_id.substring(0,8)}`)),o(u,D)};j(M,u=>{r(),i(()=>r().searchType==="transactions")&&u(p)},!0)}o(b,R)};j(L,b=>{r(),i(()=>r().searchType==="listings")?b(V):b(n,!1)},!0)}o(be,$)};j(fe,be=>{r(),i(()=>r().searchType==="users"||r().searchType==="email")?be(Te):be(Ue,!1)})}o(Pe,re)}),t(Ae),t(ne),S(()=>v(Me,`Results (${r(),i(()=>r().searchResults.length)??""})`)),o(ke,ne)};j(me,ke=>{r(),i(()=>r().searchResults.length>0)&&ke(Se)},!0)}o(oe,pe)};j(ue,oe=>{r(),i(()=>r().error)?oe(_e):oe(je,!1)},!0)}o(U,G)};j(ve,U=>{r(),i(()=>r().loading)?U(ye):U(ge,!1)})}t(m),S(()=>{Ie(O,1,`type-btn ${r(),i(()=>r().searchType==="users"?"active":"")??""}`,"svelte-1ppid2h"),Ie(B,1,`type-btn ${r(),i(()=>r().searchType==="email"?"active":"")??""}`,"svelte-1ppid2h"),Ie(ae,1,`type-btn ${r(),i(()=>r().searchType==="listings"?"active":"")??""}`,"svelte-1ppid2h"),Ie(se,1,`type-btn ${r(),i(()=>r().searchType==="transactions"?"active":"")??""}`,"svelte-1ppid2h"),zs(A,"placeholder",`Search ${r(),i(()=>r().searchType)??""}...`),Ws(A,(r(),i(()=>r().searchTerm)))}),Y("click",O,()=>I("users")),Y("click",B,()=>I("email")),Y("click",ae,()=>I("listings")),Y("click",se,()=>I("transactions")),Y("input",A,U=>x(U.target.value)),Y("keydown",A,z),Y("click",Q,w),o(T,m),ns(),ee()}var ot=_('<div class="form-feedback error svelte-1rk72og"> </div>'),nt=_('<div class="form-feedback success svelte-1rk72og">User updated successfully!</div>'),ct=_('<div class="edit-user-form svelte-1rk72og"><div class="form-row svelte-1rk72og"><div class="form-field svelte-1rk72og"><label class="svelte-1rk72og">First Name</label> <input type="text" class="svelte-1rk72og"/></div> <div class="form-field svelte-1rk72og"><label class="svelte-1rk72og">Last Name</label> <input type="text" class="svelte-1rk72og"/></div></div> <div class="form-row svelte-1rk72og"><div class="form-field svelte-1rk72og"><label class="svelte-1rk72og">Email</label> <input type="email" class="svelte-1rk72og"/></div> <div class="form-field svelte-1rk72og"><label class="svelte-1rk72og">Phone</label> <input type="tel" class="svelte-1rk72og"/></div></div> <div class="form-row svelte-1rk72og"><div class="form-field svelte-1rk72og"><label class="svelte-1rk72og">Location</label> <input type="text" class="svelte-1rk72og"/></div></div> <div class="form-row svelte-1rk72og"><div class="form-field svelte-1rk72og"><label class="svelte-1rk72og">Bio</label> <textarea rows="3" class="svelte-1rk72og"></textarea></div></div> <div class="form-row toggle-row svelte-1rk72og"><label><input type="checkbox"/> Active</label></div> <div class="form-actions svelte-1rk72og"><button class="save-btn svelte-1rk72og"> </button> <button class="cancel-btn svelte-1rk72og">Cancel</button></div> <!> <!></div>'),dt=_('<div class="detail-grid svelte-1rk72og"><div class="info-card svelte-1rk72og"><h3 class="svelte-1rk72og">Contact Information</h3> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Email:</strong> </div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Phone:</strong> </div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Location:</strong> </div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Bio:</strong> </div></div> <div class="info-card svelte-1rk72og"><h3 class="svelte-1rk72og">Statistics</h3> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Rating:</strong> </div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Total Exchanges:</strong> </div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">User Type:</strong> </div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Joined:</strong> </div></div></div> <div class="action-buttons svelte-1rk72og"><button class="edit-user-btn svelte-1rk72og">âœï¸ Edit User</button> <button class="send-apn-btn svelte-1rk72og">ğŸ”” Send APN Message</button></div>',1),ut=_('<p class="empty-state svelte-1rk72og">No listings</p>'),_t=_('<div class="list-card svelte-1rk72og"><div class="list-header svelte-1rk72og"><strong> </strong> <span> </span></div> <div> </div> <div class="list-footer svelte-1rk72og"> </div></div>'),gt=_('<div class="list-grid svelte-1rk72og"></div>'),pt=_('<p class="empty-state svelte-1rk72og">No purchases</p>'),ft=_('<div class="list-card svelte-1rk72og"><div class="list-header svelte-1rk72og"><strong> </strong> <span> </span></div> <div> </div> <div class="list-footer svelte-1rk72og"> </div></div>'),mt=_('<div class="list-grid svelte-1rk72og"></div>'),ht=_('<p class="empty-state svelte-1rk72og">No messages</p>'),bt=_('<div class="message-card svelte-1rk72og"><div class="message-header svelte-1rk72og"><span> </span> <span> </span></div> <div class="message-text svelte-1rk72og"> </div></div>'),yt=_('<div class="messages-list svelte-1rk72og"></div>'),kt=_('<p class="empty-state svelte-1rk72og">No registered devices</p>'),jt=_('<div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">App Version:</strong> </div>'),wt=_('<div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">OS Version:</strong> </div>'),xt=_('<div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Last Used:</strong> </div>'),$t=_('<div class="device-card svelte-1rk72og"><div class="device-header svelte-1rk72og"><div class="device-type svelte-1rk72og"><!> </div> <span> </span></div> <div class="device-info svelte-1rk72og"><div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Device Token:</strong> <span class="device-token svelte-1rk72og"> </span></div> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Device ID:</strong> <span class="device-id svelte-1rk72og"> </span></div> <!> <!> <div class="info-row svelte-1rk72og"><strong class="svelte-1rk72og">Registered:</strong> </div> <!></div></div>'),Lt=_('<div class="devices-list svelte-1rk72og"></div>'),St=_('<div class="detail-view svelte-1rk72og"><div class="detail-header svelte-1rk72og"><h2 class="svelte-1rk72og"> </h2> <span> </span></div> <!> <div class="section svelte-1rk72og"><h3 class="svelte-1rk72og"> </h3> <!></div> <div class="section svelte-1rk72og"><h3 class="svelte-1rk72og"> </h3> <!></div> <div class="section svelte-1rk72og"><h3 class="svelte-1rk72og"> </h3> <!></div> <div class="section svelte-1rk72og"><h3 class="svelte-1rk72og"> </h3> <!></div></div>');function Tt(T,W){os(W,!1);const r=()=>gs($s,"$userDetailState",Z),[Z,ee]=_s();let N=le(!1),g=le({}),f=le(!1),w=le(null),I=le(!1);async function x(){k(N,!e(N)),k(w,null),k(I,!1)}async function z(){k(f,!0),k(w,null),k(I,!1);try{const P=await Re("/Admin/UpdateUser",{user_id:r().currentUser.user_id,...e(g)});P.success?($s.update(A=>({...A,currentUser:{...A.currentUser,...e(g)}})),k(I,!0),setTimeout(()=>{k(I,!1),k(N,!1)},2e3)):k(w,P.error||"Failed to update user")}catch(P){k(w,P.message)}finally{k(f,!1)}}function m(){Ne.update(P=>({...P,currentView:"apn-message"}))}function C(P,A){Ne.update(Q=>({...Q,breadcrumbs:[...Q.breadcrumbs,{type:"listing",id:P,label:A}]}))}function O(P,A){Ne.update(Q=>({...Q,breadcrumbs:[...Q.breadcrumbs,{type:"transaction",id:P,label:A}]}))}ks(()=>(r(),e(g)),()=>{r().currentUser&&!e(g).Email&&k(g,{...r().currentUser||{}})}),Us(),ls();var B=Ee(),ae=$e(B);{var se=P=>{var A=St(),Q=a(A),ve=a(Q),ye=a(ve);t(ve);var ge=s(ve,2),U=a(ge,!0);t(ge),t(Q);var G=s(Q,2);{var ue=p=>{var u=ct(),D=a(u),l=a(D),E=s(a(l),2);Ye(E),t(l);var c=s(l,2),y=s(a(c),2);Ye(y),t(c),t(D);var H=s(D,2),J=a(H),te=s(a(J),2);Ye(te),t(J);var K=s(J,2),X=s(a(K),2);Ye(X),t(K),t(H);var h=s(H,2),q=a(h),ie=s(a(q),2);Ye(ie),t(q),t(h);var ce=s(h,2),Oe=a(ce),Be=s(a(Oe),2);Ds(Be),t(Oe),t(ce);var we=s(ce,2),Fe=a(we),Ge=a(Fe);Ye(Ge),is(),t(Fe),t(we);var Ce=s(we,2),De=a(Ce),We=a(De,!0);t(De);var qe=s(De,2);t(Ce);var Je=s(Ce,2);{var Ke=F=>{var ze=ot(),es=a(ze,!0);t(ze),S(()=>v(es,e(w))),o(F,ze)};j(Je,F=>{e(w)&&F(Ke)})}var cs=s(Je,2);{var de=F=>{var ze=nt();o(F,ze)};j(cs,F=>{e(I)&&F(de)})}t(u),S(()=>{De.disabled=e(f),v(We,e(f)?"Saving...":"Save")}),Qe(E,()=>e(g).FirstName,F=>as(g,e(g).FirstName=F)),Qe(y,()=>e(g).LastName,F=>as(g,e(g).LastName=F)),Qe(te,()=>e(g).Email,F=>as(g,e(g).Email=F)),Qe(X,()=>e(g).Phone,F=>as(g,e(g).Phone=F)),Qe(ie,()=>e(g).Location,F=>as(g,e(g).Location=F)),Qe(Be,()=>e(g).Bio,F=>as(g,e(g).Bio=F)),Hs(Ge,()=>e(g).IsActive,F=>as(g,e(g).IsActive=F)),Y("click",De,z),Y("click",qe,x),o(p,u)},_e=p=>{var u=dt(),D=$e(u),l=a(D),E=s(a(l),2),c=s(a(E));t(E);var y=s(E,2),H=s(a(y));t(y);var J=s(y,2),te=s(a(J));t(J);var K=s(J,2),X=s(a(K));t(K),t(l);var h=s(l,2),q=s(a(h),2),ie=s(a(q));t(q);var ce=s(q,2),Oe=s(a(ce));t(ce);var Be=s(ce,2),we=s(a(Be));t(Be);var Fe=s(Be,2),Ge=s(a(Fe));t(Fe),t(h),t(D);var Ce=s(D,2),De=a(Ce),We=s(De,2);t(Ce),S(qe=>{v(c,` ${r(),i(()=>r().currentUser.Email)??""}`),v(H,` ${r(),i(()=>r().currentUser.Phone||"-")??""}`),v(te,` ${r(),i(()=>r().currentUser.Location||"-")??""}`),v(X,` ${r(),i(()=>r().currentUser.Bio||"-")??""}`),v(ie,` ${r(),i(()=>r().currentUser.Rating)??""} â­`),v(Oe,` ${r(),i(()=>r().currentUser.TotalExchanges)??""}`),v(we,` ${r(),i(()=>r().currentUser.UserType)??""}`),v(Ge,` ${qe??""}`)},[()=>(ts(Le),r(),i(()=>Le(r().currentUser.DateCreated)))]),Y("click",De,x),Y("click",We,m),o(p,u)};j(G,p=>{e(N)?p(ue):p(_e,!1)})}var je=s(G,2),oe=a(je),pe=a(oe);t(oe);var me=s(oe,2);{var Se=p=>{var u=ut();o(p,u)},ke=p=>{var u=gt();Xe(u,5,()=>(r(),i(()=>r().userListings)),Ze,(D,l)=>{var E=_t(),c=a(E),y=a(c),H=a(y);t(y);var J=s(y,2),te=a(J,!0);t(J),t(c);var K=s(c,2),X=a(K,!0);t(K);var h=s(K,2),q=a(h,!0);t(h),t(E),S(ie=>{v(H,`${e(l),i(()=>e(l).currency)??""} â†’ ${e(l),i(()=>e(l).accept_currency)??""}`),Ie(J,1,`status-badge ${e(l),i(()=>e(l).status)??""}`,"svelte-1rk72og"),v(te,(e(l),i(()=>e(l).status))),v(X,ie),v(q,(e(l),i(()=>e(l).location)))},[()=>(ts(He),e(l),i(()=>He(e(l).amount,e(l).currency)))]),Y("click",E,()=>C(e(l).listing_id,`${e(l).currency} â†’ ${e(l).accept_currency}`)),o(D,E)}),t(u),o(p,u)};j(me,p=>{r(),i(()=>r().userListings.length===0)?p(Se):p(ke,!1)})}t(je);var ne=s(je,2),he=a(ne),Me=a(he);t(he);var Ae=s(he,2);{var Pe=p=>{var u=pt();o(p,u)},d=p=>{var u=mt();Xe(u,5,()=>(r(),i(()=>r().userPurchases)),Ze,(D,l)=>{var E=ft(),c=a(E),y=a(c),H=a(y,!0);t(y);var J=s(y,2),te=a(J,!0);t(J),t(c);var K=s(c,2),X=a(K);t(K);var h=s(K,2),q=a(h,!0);t(h),t(E),S((ie,ce)=>{v(H,ie),Ie(J,1,`status-badge ${e(l),i(()=>e(l).status)??""}`,"svelte-1rk72og"),v(te,(e(l),i(()=>e(l).status))),v(X,`Payment: ${e(l),i(()=>e(l).payment_method)??""}`),v(q,ce)},[()=>(ts(He),e(l),i(()=>He(e(l).amount_paid,e(l).currency))),()=>(ts(Le),e(l),i(()=>Le(e(l).purchased_at)))]),Y("click",E,()=>O(e(l).access_id,`Purchase ${e(l).access_id.substring(0,8)}`)),o(D,E)}),t(u),o(p,u)};j(Ae,p=>{r(),i(()=>r().userPurchases.length===0)?p(Pe):p(d,!1)})}t(ne);var re=s(ne,2),fe=a(re),Te=a(fe);t(fe);var Ue=s(fe,2);{var be=p=>{var u=ht();o(p,u)},$=p=>{var u=yt();Xe(u,5,()=>(r(),i(()=>r().userMessages)),Ze,(D,l)=>{var E=bt(),c=a(E),y=a(c),H=a(y,!0);t(y);var J=s(y,2),te=a(J,!0);t(J),t(c);var K=s(c,2),X=a(K,!0);t(K),t(E),S(h=>{v(H,(e(l),i(()=>e(l).message_type))),v(te,h),v(X,(e(l),i(()=>e(l).message_text||"-")))},[()=>(ts(Le),e(l),i(()=>Le(e(l).sent_at)))]),o(D,E)}),t(u),o(p,u)};j(Ue,p=>{r(),i(()=>r().userMessages.length===0)?p(be):p($,!1)})}t(re);var L=s(re,2),V=a(L),n=a(V);t(V);var b=s(V,2);{var R=p=>{var u=kt();o(p,u)},M=p=>{var u=Lt();Xe(u,5,()=>(r(),i(()=>r().userDevices)),Ze,(D,l)=>{var E=$t(),c=a(E),y=a(c),H=a(y);{var J=de=>{var F=vs("ğŸ“± iOS");o(de,F)},te=de=>{var F=Ee(),ze=$e(F);{var es=ss=>{var rs=vs("ğŸ¤– Android");o(ss,rs)},ds=ss=>{var rs=vs("ğŸŒ Web");o(ss,rs)};j(ze,ss=>{e(l),i(()=>e(l).device_type==="android")?ss(es):ss(ds,!1)},!0)}o(de,F)};j(H,de=>{e(l),i(()=>e(l).device_type==="ios")?de(J):de(te,!1)})}var K=s(H);t(y);var X=s(y,2),h=a(X,!0);t(X),t(c);var q=s(c,2),ie=a(q),ce=s(a(ie),2),Oe=a(ce,!0);t(ce),t(ie);var Be=s(ie,2),we=s(a(Be),2),Fe=a(we,!0);t(we),t(Be);var Ge=s(Be,2);{var Ce=de=>{var F=jt(),ze=s(a(F));t(F),S(()=>v(ze,` ${e(l),i(()=>e(l).app_version)??""}`)),o(de,F)};j(Ge,de=>{e(l),i(()=>e(l).app_version)&&de(Ce)})}var De=s(Ge,2);{var We=de=>{var F=wt(),ze=s(a(F));t(F),S(()=>v(ze,` ${e(l),i(()=>e(l).os_version)??""}`)),o(de,F)};j(De,de=>{e(l),i(()=>e(l).os_version)&&de(We)})}var qe=s(De,2),Je=s(a(qe));t(qe);var Ke=s(qe,2);{var cs=de=>{var F=xt(),ze=s(a(F));t(F),S(es=>v(ze,` ${es??""}`),[()=>(ts(Le),e(l),i(()=>Le(e(l).last_used_at)))]),o(de,F)};j(Ke,de=>{e(l),i(()=>e(l).last_used_at)&&de(cs)})}t(q),t(E),S((de,F)=>{v(K,` ${e(l),i(()=>e(l).device_name?` - ${e(l).device_name}`:"")??""}`),Ie(X,1,`status-badge ${e(l),i(()=>e(l).is_active?"active":"inactive")??""}`,"svelte-1rk72og"),v(h,(e(l),i(()=>e(l).is_active?"Active":"Inactive"))),zs(ce,"title",(e(l),i(()=>e(l).device_token||"No token"))),v(Oe,de),v(Fe,(e(l),i(()=>e(l).device_id))),v(Je,` ${F??""}`)},[()=>(e(l),i(()=>e(l).device_token?e(l).device_token.substring(0,40)+"...":"Not yet registered")),()=>(ts(Le),e(l),i(()=>Le(e(l).registered_at)))]),o(D,E)}),t(u),o(p,u)};j(b,p=>{r(),i(()=>r().userDevices.length===0)?p(R):p(M,!1)})}t(L),t(A),S(()=>{v(ye,`ğŸ‘¤ ${r(),i(()=>r().currentUser.FirstName)??""} ${r(),i(()=>r().currentUser.LastName)??""}`),Ie(ge,1,`badge ${r(),i(()=>r().currentUser.IsActive?"active":"inactive")??""}`,"svelte-1rk72og"),v(U,(r(),i(()=>r().currentUser.IsActive?"Active":"Inactive"))),v(pe,`ğŸ“‹ Listings (${r(),i(()=>r().userListings.length)??""})`),v(Me,`ğŸ’° Purchases (${r(),i(()=>r().userPurchases.length)??""})`),v(Te,`ğŸ’¬ Messages (${r(),i(()=>r().userMessages.length)??""})`),v(n,`ğŸ“± Registered Devices (${r(),i(()=>r().userDevices.length)??""})`)}),o(P,A)};j(ae,P=>{r(),i(()=>r().currentUser)&&P(se)})}o(T,B),ns(),ee()}var zt=_('<div class="info-card clickable svelte-my5gfv"><h3 class="svelte-my5gfv">ğŸ‘¤ Owner</h3> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Name:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Email:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Rating:</strong> </div> <div class="click-hint svelte-my5gfv">Click to view user â†’</div></div>'),At=_('<p class="empty-state svelte-my5gfv">No purchases yet</p>'),Ut=_('<div class="list-card svelte-my5gfv"><div class="list-header svelte-my5gfv"><strong> </strong> <span> </span></div> <div> </div> <div> </div> <div class="list-footer svelte-my5gfv"> </div></div>'),Dt=_('<div class="list-grid svelte-my5gfv"></div>'),Rt=_('<p class="empty-state svelte-my5gfv">No messages</p>'),Nt=_('<div class="message-card svelte-my5gfv"><div class="message-header svelte-my5gfv"><span> </span> <span> </span></div> <div class="message-text svelte-my5gfv"> </div></div>'),Pt=_('<div class="messages-list svelte-my5gfv"></div>'),Et=_('<div class="detail-view svelte-my5gfv"><div class="detail-header svelte-my5gfv"><h2 class="svelte-my5gfv"> </h2> <span> </span></div> <div class="detail-grid svelte-my5gfv"><div class="info-card svelte-my5gfv"><h3 class="svelte-my5gfv">Listing Details</h3> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Amount:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Location:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Coordinates:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Meeting Preference:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Available Until:</strong> </div> <div class="info-row svelte-my5gfv"><strong class="svelte-my5gfv">Created:</strong> </div></div> <!></div> <div class="section svelte-my5gfv"><h3 class="svelte-my5gfv"> </h3> <!></div> <div class="section svelte-my5gfv"><h3 class="svelte-my5gfv"> </h3> <!></div></div>');function Mt(T,W){os(W,!1);const r=()=>gs(Ns,"$listingDetailState",Z),[Z,ee]=_s();function N(x,z){Ne.update(m=>({...m,breadcrumbs:[...m.breadcrumbs,{type:"user",id:x,label:z}]}))}function g(x,z){Ne.update(m=>({...m,breadcrumbs:[...m.breadcrumbs,{type:"transaction",id:x,label:z}]}))}ls();var f=Ee(),w=$e(f);{var I=x=>{var z=Et(),m=a(z),C=a(m),O=a(C);t(C);var B=s(C,2),ae=a(B,!0);t(B),t(m);var se=s(m,2),P=a(se),A=s(a(P),2),Q=s(a(A));t(A);var ve=s(A,2),ye=s(a(ve));t(ve);var ge=s(ve,2),U=s(a(ge));t(ge);var G=s(ge,2),ue=s(a(G));t(G);var _e=s(G,2),je=s(a(_e));t(_e);var oe=s(_e,2),pe=s(a(oe));t(oe),t(P);var me=s(P,2);{var Se=$=>{var L=zt(),V=s(a(L),2),n=s(a(V));t(V);var b=s(V,2),R=s(a(b));t(b);var M=s(b,2),p=s(a(M));t(M),is(2),t(L),S(()=>{v(n,` ${r().listingOwner.FirstName??""} ${r().listingOwner.LastName??""}`),v(R,` ${r().listingOwner.Email??""}`),v(p,` ${r().listingOwner.Rating??""} â­`)}),Y("click",L,()=>N(r().listingOwner.user_id,`${r().listingOwner.FirstName} ${r().listingOwner.LastName}`)),o($,L)};j(me,$=>{r().listingOwner&&$(Se)})}t(se);var ke=s(se,2),ne=a(ke),he=a(ne);t(ne);var Me=s(ne,2);{var Ae=$=>{var L=At();o($,L)},Pe=$=>{var L=Dt();Xe(L,5,()=>r().listingPurchases,Ze,(V,n)=>{var b=Ut(),R=a(b),M=a(R),p=a(M,!0);t(M);var u=s(M,2),D=a(u,!0);t(u),t(R);var l=s(R,2),E=a(l);t(l);var c=s(l,2),y=a(c);t(c);var H=s(c,2),J=a(H,!0);t(H),t(b),S((te,K,X)=>{v(p,te),Ie(u,1,`status-badge ${e(n).status??""}`,"svelte-my5gfv"),v(D,e(n).status),v(E,`Buyer ID: ${K??""}...`),v(y,`Payment: ${e(n).payment_method??""}`),v(J,X)},[()=>He(e(n).amount_paid,e(n).currency),()=>e(n).user_id.substring(0,12),()=>Le(e(n).purchased_at)]),Y("click",b,()=>g(e(n).access_id,`Purchase ${e(n).access_id.substring(0,8)}`)),o(V,b)}),t(L),o($,L)};j(Me,$=>{r().listingPurchases.length===0?$(Ae):$(Pe,!1)})}t(ke);var d=s(ke,2),re=a(d),fe=a(re);t(re);var Te=s(re,2);{var Ue=$=>{var L=Rt();o($,L)},be=$=>{var L=Pt();Xe(L,5,()=>r().listingMessages,Ze,(V,n)=>{var b=Nt(),R=a(b),M=a(R),p=a(M);t(M);var u=s(M,2),D=a(u,!0);t(u),t(R);var l=s(R,2),E=a(l,!0);t(l),t(b),S((c,y)=>{v(p,`From: ${c??""}...`),v(D,y),v(E,e(n).message_text||"-")},[()=>e(n).sender_id.substring(0,12),()=>Le(e(n).sent_at)]),o(V,b)}),t(L),o($,L)};j(Te,$=>{r().listingMessages.length===0?$(Ue):$(be,!1)})}t(d),t(z),S(($,L,V)=>{v(O,`ğŸ’± ${r().currentListing.currency??""} â†’ ${r().currentListing.accept_currency??""}`),Ie(B,1,`badge ${r().currentListing.status??""}`,"svelte-my5gfv"),v(ae,r().currentListing.status),v(Q,` ${$??""}`),v(ye,` ${r().currentListing.location??""}`),v(U,` ${r().currentListing.latitude??""}, ${r().currentListing.longitude??""}`),v(ue,` ${r().currentListing.meeting_preference??""}`),v(je,` ${L??""}`),v(pe,` ${V??""}`),v(he,`ğŸ’° Purchases (${r().listingPurchases.length??""})`),v(fe,`ğŸ’¬ Messages (${r().listingMessages.length??""})`)},[()=>He(r().currentListing.amount,r().currentListing.currency),()=>Le(r().currentListing.available_until),()=>Le(r().currentListing.created_at)]),o(x,z)};j(w,x=>{r().currentListing&&x(I)})}o(T,f),ns(),ee()}var Bt=_('<div class="info-card clickable svelte-jjb0dz"><h4 class="svelte-jjb0dz">ğŸ’³ Buyer</h4> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Name:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Email:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Rating:</strong> </div> <div class="click-hint svelte-jjb0dz">Click to view user â†’</div></div>'),Ft=_('<div class="info-card clickable svelte-jjb0dz"><h4 class="svelte-jjb0dz">ğŸ’° Seller</h4> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Name:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Email:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Rating:</strong> </div> <div class="click-hint svelte-jjb0dz">Click to view user â†’</div></div>'),Vt=_('<div class="section svelte-jjb0dz"><h3 class="svelte-jjb0dz">ğŸ“‹ Related Listing</h3> <div class="info-card clickable svelte-jjb0dz"><div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Exchange:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Amount:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Location:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Status:</strong> </div> <div class="click-hint svelte-jjb0dz">Click to view listing â†’</div></div></div>'),It=_('<div class="detail-view svelte-jjb0dz"><div class="detail-header svelte-jjb0dz"><h2 class="svelte-jjb0dz">ğŸ’° Transaction Details</h2> <span> </span></div> <div class="detail-grid svelte-jjb0dz"><div class="info-card svelte-jjb0dz"><h3 class="svelte-jjb0dz">Payment Information</h3> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Amount Paid:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Payment Method:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Transaction ID:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Purchased:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Expires:</strong> </div></div> <div class="info-card svelte-jjb0dz"><h3 class="svelte-jjb0dz">Exchange Rate Info</h3> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">From Currency:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">To Currency:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Exchange Rate:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Locked Amount:</strong> </div> <div class="info-row svelte-jjb0dz"><strong class="svelte-jjb0dz">Rate Date:</strong> </div></div></div> <div class="section svelte-jjb0dz"><h3 class="svelte-jjb0dz">ğŸ‘¥ Parties Involved</h3> <div class="detail-grid svelte-jjb0dz"><!> <!></div></div> <!></div>');function Ct(T,W){os(W,!1);const r=()=>gs(Ps,"$transactionDetailState",Z),[Z,ee]=_s();function N(x,z){Ne.update(m=>({...m,breadcrumbs:[...m.breadcrumbs,{type:"user",id:x,label:z}]}))}function g(x,z){Ne.update(m=>({...m,breadcrumbs:[...m.breadcrumbs,{type:"listing",id:x,label:z}]}))}ls();var f=Ee(),w=$e(f);{var I=x=>{var z=It(),m=a(z),C=s(a(m),2),O=a(C,!0);t(C),t(m);var B=s(m,2),ae=a(B),se=s(a(ae),2),P=s(a(se));t(se);var A=s(se,2),Q=s(a(A));t(A);var ve=s(A,2),ye=s(a(ve));t(ve);var ge=s(ve,2),U=s(a(ge));t(ge);var G=s(ge,2),ue=s(a(G));t(G),t(ae);var _e=s(ae,2),je=s(a(_e),2),oe=s(a(je));t(je);var pe=s(je,2),me=s(a(pe));t(pe);var Se=s(pe,2),ke=s(a(Se));t(Se);var ne=s(Se,2),he=s(a(ne));t(ne);var Me=s(ne,2),Ae=s(a(Me));t(Me),t(_e),t(B);var Pe=s(B,2),d=s(a(Pe),2),re=a(d);{var fe=L=>{var V=Bt(),n=s(a(V),2),b=s(a(n));t(n);var R=s(n,2),M=s(a(R));t(R);var p=s(R,2),u=s(a(p));t(p),is(2),t(V),S(()=>{v(b,` ${r().transactionBuyer.FirstName??""} ${r().transactionBuyer.LastName??""}`),v(M,` ${r().transactionBuyer.Email??""}`),v(u,` ${r().transactionBuyer.Rating??""} â­`)}),Y("click",V,()=>N(r().transactionBuyer.user_id,`${r().transactionBuyer.FirstName} ${r().transactionBuyer.LastName}`)),o(L,V)};j(re,L=>{r().transactionBuyer&&L(fe)})}var Te=s(re,2);{var Ue=L=>{var V=Ft(),n=s(a(V),2),b=s(a(n));t(n);var R=s(n,2),M=s(a(R));t(R);var p=s(R,2),u=s(a(p));t(p),is(2),t(V),S(()=>{v(b,` ${r().transactionSeller.FirstName??""} ${r().transactionSeller.LastName??""}`),v(M,` ${r().transactionSeller.Email??""}`),v(u,` ${r().transactionSeller.Rating??""} â­`)}),Y("click",V,()=>N(r().transactionSeller.user_id,`${r().transactionSeller.FirstName} ${r().transactionSeller.LastName}`)),o(L,V)};j(Te,L=>{r().transactionSeller&&L(Ue)})}t(d),t(Pe);var be=s(Pe,2);{var $=L=>{var V=Vt(),n=s(a(V),2),b=a(n),R=s(a(b));t(b);var M=s(b,2),p=s(a(M));t(M);var u=s(M,2),D=s(a(u));t(u);var l=s(u,2),E=s(a(l));t(l),is(2),t(n),t(V),S(c=>{v(R,` ${r().transactionListing.currency??""} â†’ ${r().transactionListing.accept_currency??""}`),v(p,` ${c??""}`),v(D,` ${r().transactionListing.location??""}`),v(E,` ${r().transactionListing.status??""}`)},[()=>He(r().transactionListing.amount,r().transactionListing.currency)]),Y("click",n,()=>g(r().transactionListing.listing_id,`${r().transactionListing.currency} â†’ ${r().transactionListing.accept_currency}`)),o(L,V)};j(be,L=>{r().transactionListing&&L($)})}t(z),S((L,V,n,b)=>{Ie(C,1,`badge ${r().currentTransaction.status??""}`,"svelte-jjb0dz"),v(O,r().currentTransaction.status),v(P,` ${L??""}`),v(Q,` ${r().currentTransaction.payment_method??""}`),v(ye,` ${(r().currentTransaction.transaction_id||"-")??""}`),v(U,` ${V??""}`),v(ue,` ${n??""}`),v(oe,` ${(r().currentTransaction.from_currency||"-")??""}`),v(me,` ${(r().currentTransaction.to_currency||"-")??""}`),v(ke,` ${(r().currentTransaction.exchange_rate||"-")??""}`),v(he,` ${b??""}`),v(Ae,` ${(r().currentTransaction.rate_calculation_date||"-")??""}`)},[()=>He(r().currentTransaction.amount_paid,r().currentTransaction.currency),()=>Le(r().currentTransaction.purchased_at),()=>Le(r().currentTransaction.expires_at)||"Never",()=>r().currentTransaction.locked_amount?He(r().currentTransaction.locked_amount,r().currentTransaction.to_currency):"-"]),o(x,z)};j(w,x=>{r().currentTransaction&&x(I)})}o(T,f),ns(),ee()}var Ot=_('<div class="alert alert-warning svelte-1o65j8h">âš ï¸ No devices registered for this user</div>'),Gt=_('<span class="badge badge-success svelte-1o65j8h">âœ“ Ready</span>'),qt=_('<span class="badge badge-warning svelte-1o65j8h">âš  Not Ready</span>'),Wt=_('<div class="svelte-1o65j8h"><strong class="svelte-1o65j8h">Name:</strong> </div>'),Ht=_('<div class="svelte-1o65j8h"><strong class="svelte-1o65j8h">App:</strong> </div>'),Jt=_('<div><div class="device-header-row svelte-1o65j8h"><div class="device-type-badge svelte-1o65j8h"><!></div> <div class="device-status svelte-1o65j8h"><!></div></div> <div class="device-details svelte-1o65j8h"><!> <div class="svelte-1o65j8h"><strong class="svelte-1o65j8h">Type:</strong> </div> <!> <div class="svelte-1o65j8h"><strong class="svelte-1o65j8h">Token:</strong> <span> </span></div> <div class="svelte-1o65j8h"><strong class="svelte-1o65j8h">Active:</strong> <span> </span></div></div></div>'),Kt=_('<div class="alert alert-error svelte-1o65j8h">âŒ No active iOS devices with valid tokens. Cannot send notification. <br/> The user needs to: <ul class="svelte-1o65j8h"><li class="svelte-1o65j8h">Install the app on an iOS device</li> <li class="svelte-1o65j8h">Log in and allow push notifications</li> <li class="svelte-1o65j8h">Device must be marked as active in the database</li></ul></div>'),Yt=_('<div class="alert alert-success svelte-1o65j8h"> </div>'),Qt=_('<div class="devices-info svelte-1o65j8h"></div> <!>',1),Xt=_("<option>No active devices available</option>"),Zt=_("<option> <!></option>"),ea=_('<div class="result-icon svelte-1o65j8h">âœ“</div>'),sa=_('<div class="result-icon svelte-1o65j8h">âœ•</div>'),ta=_('<div><!> <p class="svelte-1o65j8h"> </p></div>'),aa=_('<div class="message-view svelte-1o65j8h"><div class="header svelte-1o65j8h"><button class="back-btn svelte-1o65j8h">â† Back</button> <h2 class="svelte-1o65j8h">Send APN Message</h2> <div class="user-info svelte-1o65j8h"><strong> </strong> <span class="email svelte-1o65j8h"> </span></div></div> <div class="form-container svelte-1o65j8h"><div class="device-status-section svelte-1o65j8h"><h3 class="svelte-1o65j8h">ğŸ“± Registered iOS Devices</h3> <!></div> <div class="form-group svelte-1o65j8h"><label for="device" class="svelte-1o65j8h">Select Device to Send To</label> <select id="device" class="svelte-1o65j8h"><!></select></div> <div class="form-group svelte-1o65j8h"><label for="title" class="svelte-1o65j8h">Notification Title</label> <input id="title" type="text" placeholder="Enter notification title" maxlength="100" class="svelte-1o65j8h"/> <span class="char-count svelte-1o65j8h"> </span></div> <div class="form-group svelte-1o65j8h"><label for="body" class="svelte-1o65j8h">Message Body</label> <textarea id="body" placeholder="Enter notification message" rows="5" maxlength="500" class="svelte-1o65j8h"></textarea> <span class="char-count svelte-1o65j8h"> </span></div> <div class="form-row svelte-1o65j8h"><div class="form-group svelte-1o65j8h"><label for="badge" class="svelte-1o65j8h">Badge Number</label> <input id="badge" type="number" min="0" max="999" class="svelte-1o65j8h"/></div> <div class="form-group svelte-1o65j8h"><label for="sound" class="svelte-1o65j8h">Sound</label> <select id="sound" class="svelte-1o65j8h"><option>Default</option><option>Silent</option></select></div></div> <div class="button-group svelte-1o65j8h"><button class="btn-cancel svelte-1o65j8h">Cancel</button> <button class="btn-send svelte-1o65j8h"> </button></div> <!></div></div>');function ra(T,W){os(W,!1);const r=()=>gs($s,"$userDetailState",Z),[Z,ee]=_s(),N=le(),g=le(),f=le();let w=le(""),I=le(""),x=le(1),z=le("default"),m=le(!1),C=le(null),O=le(!1),B=le(null);async function ae(){if(!e(w).trim()){alert("Please enter a notification title");return}if(!e(I).trim()){alert("Please enter a notification message");return}if(!e(f)){alert("No active iOS devices found for this user. Devices must be marked as active and have a valid device token.");return}if(!e(B)){alert("Please select a device to send to");return}k(m,!0),k(O,!1);try{const c=await Re("/Admin/SendApnMessage",{user_id:r().currentUser.user_id,device_id:e(B),title:e(w),body:e(I),badge:e(x),sound:e(z)});c&&c.success?(k(C,{success:!0,message:c.message||"Message sent successfully"}),k(w,""),k(I,""),k(x,1)):k(C,{success:!1,message:c?.error||"Failed to send message"})}catch(c){k(C,{success:!1,message:c.message||"Error sending message"})}finally{k(m,!1),k(O,!0),setTimeout(()=>{k(O,!1)},5e3)}}function se(){Ne.update(c=>({...c,currentView:"user"}))}ks(()=>r(),()=>{k(N,r().userDevices.filter(c=>c.device_type==="ios"))}),ks(()=>r(),()=>{k(g,r().userDevices.filter(c=>c.device_type==="ios"&&c.device_token&&c.is_active===1))}),ks(()=>e(g),()=>{k(f,e(g).length>0)}),ks(()=>(e(B),e(g)),()=>{e(B)===null&&e(g).length>0&&!e(B)&&k(B,e(g)[0].device_id)}),Us(),ls();var P=aa(),A=a(P),Q=a(A),ve=s(Q,4),ye=a(ve),ge=a(ye);t(ye);var U=s(ye,2),G=a(U,!0);t(U),t(ve),t(A);var ue=s(A,2),_e=a(ue),je=s(a(_e),2);{var oe=c=>{var y=Ot();o(c,y)},pe=c=>{var y=Qt(),H=$e(y);Xe(H,5,()=>(r(),i(()=>r().userDevices)),Ze,(X,h)=>{var q=Jt(),ie=a(q),ce=a(ie),Oe=a(ce);{var Be=xe=>{var Ve=vs("ğŸ“± iOS");o(xe,Ve)},we=xe=>{var Ve=Ee(),us=$e(Ve);{var Ls=ps=>{var xs=vs("ğŸ¤– Android");o(ps,xs)},Es=ps=>{var xs=vs();S(()=>v(xs,`ğŸŒ ${e(h),i(()=>e(h).device_type)??""}`)),o(ps,xs)};j(us,ps=>{e(h),i(()=>e(h).device_type==="android")?ps(Ls):ps(Es,!1)},!0)}o(xe,Ve)};j(Oe,xe=>{e(h),i(()=>e(h).device_type==="ios")?xe(Be):xe(we,!1)})}t(ce);var Fe=s(ce,2),Ge=a(Fe);{var Ce=xe=>{var Ve=Gt();o(xe,Ve)},De=xe=>{var Ve=qt();o(xe,Ve)};j(Ge,xe=>{e(h),i(()=>e(h).device_type==="ios"&&e(h).is_active===1&&e(h).device_token)?xe(Ce):xe(De,!1)})}t(Fe),t(ie);var We=s(ie,2),qe=a(We);{var Je=xe=>{var Ve=Wt(),us=s(a(Ve));t(Ve),S(()=>v(us,` ${e(h),i(()=>e(h).device_name)??""}`)),o(xe,Ve)};j(qe,xe=>{e(h),i(()=>e(h).device_name)&&xe(Je)})}var Ke=s(qe,2),cs=s(a(Ke));t(Ke);var de=s(Ke,2);{var F=xe=>{var Ve=Ht(),us=s(a(Ve));t(Ve),S(()=>v(us,` ${e(h),i(()=>e(h).app_version)??""}`)),o(xe,Ve)};j(de,xe=>{e(h),i(()=>e(h).app_version)&&xe(F)})}var ze=s(de,2),es=s(a(ze),2),ds=a(es,!0);t(es),t(ze);var ss=s(ze,2),rs=s(a(ss),2),bs=a(rs,!0);t(rs),t(ss),t(We),t(q),S(()=>{Ie(q,1,`device-item ${e(h),i(()=>e(h).device_type==="ios"?"ios":"other")??""}`,"svelte-1o65j8h"),v(cs,` ${e(h),i(()=>e(h).device_type)??""}`),Ie(es,1,`device-token-indicator ${e(h),i(()=>e(h).device_token?"has-token":"no-token")??""}`,"svelte-1o65j8h"),v(ds,(e(h),i(()=>e(h).device_token?"âœ“ Registered":"âœ— Missing"))),Ie(rs,1,`active-indicator ${e(h),i(()=>e(h).is_active?"active":"inactive")??""}`,"svelte-1o65j8h"),v(bs,(e(h),i(()=>e(h).is_active?"Yes":"No")))}),o(X,q)}),t(H);var J=s(H,2);{var te=X=>{var h=Kt();o(X,h)},K=X=>{var h=Yt(),q=a(h);t(h),S(()=>v(q,`âœ“ ${e(g),i(()=>e(g).length)??""} active device(s) ready to receive notifications`)),o(X,h)};j(J,X=>{e(f)?X(K,!1):X(te)})}o(c,y)};j(je,c=>{r(),i(()=>r().userDevices.length===0)?c(oe):c(pe,!1)})}t(_e);var me=s(_e,2),Se=s(a(me),2);S(()=>{e(B),ms(()=>{e(m),e(f),e(g)})});var ke=a(Se);{var ne=c=>{var y=Xt();y.value=(y.__value=null)??"",o(c,y)},he=c=>{var y=Ee(),H=$e(y);Xe(H,1,()=>e(g),Ze,(J,te)=>{var K=Zt(),X=a(K),h=s(X);{var q=ce=>{var Oe=vs("âœ“");o(ce,Oe)};j(h,ce=>{e(te),i(()=>e(te).is_active===1)&&ce(q)})}t(K);var ie={};S(ce=>{v(X,`${ce??""} `),ie!==(ie=(e(te),i(()=>e(te).device_id)))&&(K.value=(K.__value=(e(te),i(()=>e(te).device_id)))??"")},[()=>(e(te),i(()=>e(te).device_name||`Device ${e(te).device_id.substring(0,8)}`))]),o(J,K)}),o(c,y)};j(ke,c=>{e(f)?c(he,!1):c(ne)})}t(Se),t(me);var Me=s(me,2),Ae=s(a(Me),2);Ye(Ae);var Pe=s(Ae,2),d=a(Pe);t(Pe),t(Me);var re=s(Me,2),fe=s(a(re),2);Ds(fe);var Te=s(fe,2),Ue=a(Te);t(Te),t(re);var be=s(re,2),$=a(be),L=s(a($),2);Ye(L),t($);var V=s($,2),n=s(a(V),2);S(()=>{e(z),ms(()=>{e(m),e(f)})});var b=a(n);b.value=b.__value="default";var R=s(b);R.value=R.__value="silent",t(n),t(V),t(be);var M=s(be,2),p=a(M),u=s(p,2),D=a(u,!0);t(u),t(M);var l=s(M,2);{var E=c=>{var y=ta(),H=a(y);{var J=h=>{var q=ea();o(h,q)},te=h=>{var q=sa();o(h,q)};j(H,h=>{e(C),i(()=>e(C).success)?h(J):h(te,!1)})}var K=s(H,2),X=a(K,!0);t(K),t(y),S(()=>{Ie(y,1,`result ${e(C),i(()=>e(C).success?"success":"error")??""}`,"svelte-1o65j8h"),v(X,(e(C),i(()=>e(C).message)))}),o(c,y)};j(l,c=>{e(O)&&c(E)})}t(ue),t(P),S(()=>{v(ge,`${r(),i(()=>r().currentUser.FirstName)??""} ${r(),i(()=>r().currentUser.LastName)??""}`),v(G,(r(),i(()=>r().currentUser.Email))),Se.disabled=e(m)||!e(f),Ae.disabled=e(m)||!e(f),v(d,`${e(w),i(()=>e(w).length)??""}/100`),fe.disabled=e(m)||!e(f),v(Ue,`${e(I),i(()=>e(I).length)??""}/500`),L.disabled=e(m)||!e(f),n.disabled=e(m)||!e(f),p.disabled=e(m),u.disabled=e(m)||!e(f)||!e(B),zs(u,"title",e(f)?e(B)?"Send notification":"Select a device":"No active devices available"),v(D,e(m)?"Sending...":"Send to Selected Device")}),Y("click",Q,se),hs(Se,()=>e(B),c=>k(B,c)),Qe(Ae,()=>e(w),c=>k(w,c)),Qe(fe,()=>e(I),c=>k(I,c)),Qe(L,()=>e(x),c=>k(x,c)),hs(n,()=>e(z),c=>k(z,c)),Y("click",p,se),Y("click",u,ae),o(T,P),ns(),ee()}var va=_('<div class="metadata-panel svelte-rvmo8o"><span class="svelte-rvmo8o"><strong class="svelte-rvmo8o">File:</strong> </span> <span class="svelte-rvmo8o"><strong class="svelte-rvmo8o">Total Lines:</strong> </span> <span class="svelte-rvmo8o"><strong class="svelte-rvmo8o">Showing:</strong> </span> <span class="svelte-rvmo8o"><strong class="svelte-rvmo8o">Size:</strong> </span> <span class="svelte-rvmo8o"><strong class="svelte-rvmo8o">Modified:</strong> </span></div>'),ia=_('<div class="debug-panel svelte-rvmo8o"><strong>Debug:</strong> <!></div>'),la=_('<div class="error-message svelte-rvmo8o"> </div>'),oa=_('<div class="loading-state svelte-rvmo8o">â³ Loading logs...</div>'),na=_('<pre class="logs-content svelte-rvmo8o"> </pre>'),ca=_('<div class="empty-state svelte-rvmo8o"><!></div>'),da=_('<div class="logs-view svelte-rvmo8o"><div class="logs-header svelte-rvmo8o"><h2 class="svelte-rvmo8o">ğŸ“‹ Server Logs</h2></div> <div class="controls-panel svelte-rvmo8o"><div class="control-group svelte-rvmo8o"><label class="svelte-rvmo8o">Log Type:</label> <select class="svelte-rvmo8o"><option>Flask Application</option><option>Error Log</option></select></div> <div class="control-group svelte-rvmo8o"><label class="svelte-rvmo8o">Lines:</label> <select class="svelte-rvmo8o"><option>50</option><option>100</option><option>250</option><option>500</option><option>1000</option></select></div> <div class="control-group search-group svelte-rvmo8o"><label class="svelte-rvmo8o">Search:</label> <input type="text" placeholder="Filter logs..." class="svelte-rvmo8o"/></div> <div class="control-buttons svelte-rvmo8o"><button class="refresh-btn svelte-rvmo8o"> </button> <button> </button> <button class="clear-btn svelte-rvmo8o">ğŸ—‘ï¸ Clear Logs</button></div></div> <!> <!> <!> <div class="logs-container svelte-rvmo8o"><!></div></div>');function ua(T,W){os(W,!1);let r=le("flask"),Z=le(100),ee=le(""),N=le(""),g=le(!1),f=le(null),w=le(null),I=le(!1),x=null,z=le(null);async function m(){k(g,!0),k(f,null);try{const n=await Re("/Admin/GetLogs",{type:e(r),lines:e(Z),search:e(ee)});console.log("GetLogs response:",n),k(z,{success:n.success,hasLogs:!!n.logs,logsLength:n.logs?n.logs.length:0,error:n.error}),n.success?(k(N,n.logs),k(w,{total_lines:n.total_lines,returned_lines:n.returned_lines,file_size_bytes:n.file_size_bytes,last_modified:n.last_modified,log_file:n.log_file})):(k(f,n.error||"Failed to load logs"),k(N,""))}catch(n){console.error("Error loading logs:",n),k(f,n.message||"Network error loading logs"),k(N,"")}finally{k(g,!1)}}async function C(){if(confirm(`Are you sure you want to clear the ${e(r)} logs? This cannot be undone.`)){k(g,!0),k(f,null);try{const n=await Re("/Admin/ClearLogs",{type:e(r)},"POST");n.success?(k(N,""),await m()):k(f,n.error||"Failed to clear logs")}catch(n){k(f,n.message)}finally{k(g,!1)}}}function O(){k(I,!e(I)),e(I)?x=setInterval(()=>{m()},3e3):x&&(clearInterval(x),x=null)}function B(n){if(n===0)return"0 Bytes";const b=1024,R=["Bytes","KB","MB","GB"],M=Math.floor(Math.log(n)/Math.log(b));return Math.round(n/Math.pow(b,M)*100)/100+" "+R[M]}function ae(n){if(!n)return"-";try{return new Date(n).toLocaleString()}catch{return n}}m(),ls();var se=da(),P=s(a(se),2),A=a(P),Q=s(a(A),2);S(()=>{e(r),ms(()=>{})});var ve=a(Q);ve.value=ve.__value="flask";var ye=s(ve);ye.value=ye.__value="error",t(Q),t(A);var ge=s(A,2),U=s(a(ge),2);S(()=>{e(Z),ms(()=>{})});var G=a(U);G.value=G.__value="50";var ue=s(G);ue.value=ue.__value="100";var _e=s(ue);_e.value=_e.__value="250";var je=s(_e);je.value=je.__value="500";var oe=s(je);oe.value=oe.__value="1000",t(U),t(ge);var pe=s(ge,2),me=s(a(pe),2);Ye(me),t(pe);var Se=s(pe,2),ke=a(Se),ne=a(ke,!0);t(ke);var he=s(ke,2),Me=a(he,!0);t(he);var Ae=s(he,2);t(Se),t(P);var Pe=s(P,2);{var d=n=>{var b=va(),R=a(b),M=s(a(R));t(R);var p=s(R,2),u=s(a(p));t(p);var D=s(p,2),l=s(a(D));t(D);var E=s(D,2),c=s(a(E));t(E);var y=s(E,2),H=s(a(y));t(y),t(b),S((J,te,K,X)=>{v(M,` ${e(w).log_file??""}`),v(u,` ${J??""}`),v(l,` ${te??""}`),v(c,` ${K??""}`),v(H,` ${X??""}`)},[()=>e(w).total_lines.toLocaleString(),()=>e(w).returned_lines.toLocaleString(),()=>B(e(w).file_size_bytes),()=>ae(e(w).last_modified)]),o(n,b)};j(Pe,n=>{e(w)&&n(d)})}var re=s(Pe,2);{var fe=n=>{var b=ia(),R=s(a(b)),M=s(R);{var p=u=>{var D=vs();S(()=>v(D,`| Error: ${e(z).error??""}`)),o(u,D)};j(M,u=>{e(z).error&&u(p)})}t(b),S(()=>v(R,` Success: ${e(z).success?"âœ“":"âœ—"} |
			Has Logs: ${e(z).hasLogs?"Yes":"No"} |
			Length: ${e(z).logsLength??""} chars `)),o(n,b)};j(re,n=>{e(z)&&n(fe)})}var Te=s(re,2);{var Ue=n=>{var b=la(),R=a(b);t(b),S(()=>v(R,`âŒ ${e(f)??""}`)),o(n,b)};j(Te,n=>{e(f)&&n(Ue)})}var be=s(Te,2),$=a(be);{var L=n=>{var b=oa();o(n,b)},V=n=>{var b=Ee(),R=$e(b);{var M=u=>{var D=na(),l=a(D,!0);t(D),S(()=>v(l,e(N))),o(u,D)},p=u=>{var D=ca(),l=a(D);{var E=y=>{var H=vs("Check error message above");o(y,H)},c=y=>{var H=vs("No logs available or log file is empty");o(y,H)};j(l,y=>{e(f)?y(E):y(c,!1)})}t(D),o(u,D)};j(R,u=>{e(N)?u(M):u(p,!1)},!0)}o(n,b)};j($,n=>{e(g)&&!e(N)?n(L):n(V,!1)})}t(be),t(se),S(()=>{ke.disabled=e(g),v(ne,e(g)?"â³ Loading...":"ğŸ”„ Refresh"),Ie(he,1,`auto-refresh-btn ${e(I)?"active":""}`,"svelte-rvmo8o"),v(Me,e(I)?"â¸ Stop Auto":"â–¶ Auto Refresh"),Ae.disabled=e(g)}),hs(Q,()=>e(r),n=>k(r,n)),Y("change",Q,m),hs(U,()=>e(Z),n=>k(Z,n)),Y("change",U,m),Qe(me,()=>e(ee),n=>k(ee,n)),Y("input",me,m),Y("click",ke,m),Y("click",he,O),Y("click",Ae,C),o(T,se),ns()}var _a=_('<div class="error-message svelte-p571ei"><strong>Error:</strong> </div>'),ga=_('<div class="method-card svelte-p571ei"><h5 class="svelte-p571ei"> </h5> <p class="svelte-p571ei"><strong> </strong> transactions</p> <p class="amount svelte-p571ei"> </p></div>'),pa=_('<div class="methods-section svelte-p571ei"><h3 class="svelte-p571ei">Payment Method Breakdown</h3> <div class="methods-grid svelte-p571ei"></div></div>'),fa=_('<tr class="svelte-p571ei"><td class="svelte-p571ei"> </td><td class="svelte-p571ei"><code class="svelte-p571ei"> </code></td><td class="svelte-p571ei"><code class="svelte-p571ei"> </code></td><td class="amount svelte-p571ei"> </td><td class="svelte-p571ei"> </td><td class="svelte-p571ei"> </td><td class="svelte-p571ei"><span> </span></td></tr>'),ma=_('<div class="table-container svelte-p571ei"><table class="transactions-table svelte-p571ei"><thead class="svelte-p571ei"><tr><th class="svelte-p571ei">Date</th><th class="svelte-p571ei">User ID</th><th class="svelte-p571ei">Listing ID</th><th class="svelte-p571ei">Amount</th><th class="svelte-p571ei">Currency</th><th class="svelte-p571ei">Payment Method</th><th class="svelte-p571ei">Status</th></tr></thead><tbody class="svelte-p571ei"></tbody></table></div>'),ha=_('<p class="no-data svelte-p571ei">No transactions found matching the selected filters.</p>'),ba=_('<div class="stats-grid svelte-p571ei"><div class="stat-card svelte-p571ei"><h4 class="svelte-p571ei">Total Transactions</h4> <p class="stat-value svelte-p571ei"> </p></div> <div class="stat-card svelte-p571ei"><h4 class="svelte-p571ei">Total Amount</h4> <p class="stat-value svelte-p571ei"> </p></div> <div class="stat-card svelte-p571ei"><h4 class="svelte-p571ei">Average Amount</h4> <p class="stat-value svelte-p571ei"> </p></div> <div class="stat-card svelte-p571ei"><h4 class="svelte-p571ei">Unique Users</h4> <p class="stat-value svelte-p571ei"> </p></div> <div class="stat-card svelte-p571ei"><h4 class="svelte-p571ei">Unique Listings</h4> <p class="stat-value svelte-p571ei"> </p></div></div> <!> <div class="transactions-section svelte-p571ei"><h3 class="svelte-p571ei"> </h3> <!></div>',1),ya=_('<div class="reports-container svelte-p571ei"><div class="reports-header svelte-p571ei"><h2 class="svelte-p571ei">ğŸ’³ Payment Reports</h2> <p class="svelte-p571ei">View and analyze payment transactions</p></div> <div class="filter-section svelte-p571ei"><div class="filters svelte-p571ei"><div class="filter-group svelte-p571ei"><label class="svelte-p571ei">Start Date</label> <input type="date" class="svelte-p571ei"/></div> <div class="filter-group svelte-p571ei"><label class="svelte-p571ei">End Date</label> <input type="date" class="svelte-p571ei"/></div> <div class="filter-group svelte-p571ei"><label class="svelte-p571ei">Payment Method</label> <select class="svelte-p571ei"><option>All Methods</option><option>PayPal</option><option>Stripe</option><option>Crypto</option></select></div> <div class="filter-group svelte-p571ei"><label class="svelte-p571ei">Status</label> <select class="svelte-p571ei"><option>All Status</option><option>Completed</option><option>Pending</option><option>Failed</option></select></div></div> <div class="button-group svelte-p571ei"><button class="btn btn-primary svelte-p571ei"> </button> <button class="btn btn-secondary svelte-p571ei">Reset</button> <button class="btn btn-secondary svelte-p571ei">ğŸ“¥ Export CSV</button></div></div> <!> <!></div>');function ka(T,W){os(W,!1);let r=le(!1),Z=le(null),ee=le(null),N=le(null),g=le([]),f=le({start_date:"",end_date:"",payment_method:"",status:""});async function w(){k(r,!0),k(Z,null);try{const d=await Re("/Admin/GetPaymentReports",e(f));if(!d.success)throw new Error(d.error||"Failed to load payment reports");k(ee,d.transactions),k(N,d.stats),k(g,d.payment_methods||[])}catch(d){k(Z,d.message),console.error("Error loading payment reports:",d)}finally{k(r,!1)}}function I(){if(!e(ee)||e(ee).length===0){alert("No data to export");return}const d=["Date","User ID","Listing ID","Amount","Currency","Payment Method","Status"],re=e(ee).map($=>[Le($.purchased_at),$.user_id,$.listing_id,$.amount_paid,$.currency,$.payment_method,$.status||"completed"]),fe=[d,...re].map($=>$.map(L=>`"${L}"`).join(",")).join(`
`),Te=new Blob([fe],{type:"text/csv"}),Ue=window.URL.createObjectURL(Te),be=document.createElement("a");be.href=Ue,be.download=`payment-report-${new Date().toISOString().split("T")[0]}.csv`,be.click()}function x(){k(f,{start_date:"",end_date:"",payment_method:"",status:""}),w()}ls();var z=ya(),m=s(a(z),2),C=a(m),O=a(C),B=s(a(O),2);Ye(B),t(O);var ae=s(O,2),se=s(a(ae),2);Ye(se),t(ae);var P=s(ae,2),A=s(a(P),2);S(()=>{e(f),ms(()=>{})});var Q=a(A);Q.value=Q.__value="";var ve=s(Q);ve.value=ve.__value="paypal";var ye=s(ve);ye.value=ye.__value="stripe";var ge=s(ye);ge.value=ge.__value="crypto",t(A),t(P);var U=s(P,2),G=s(a(U),2);S(()=>{e(f),ms(()=>{})});var ue=a(G);ue.value=ue.__value="";var _e=s(ue);_e.value=_e.__value="completed";var je=s(_e);je.value=je.__value="pending";var oe=s(je);oe.value=oe.__value="failed",t(G),t(U),t(C);var pe=s(C,2),me=a(pe),Se=a(me,!0);t(me);var ke=s(me,2),ne=s(ke,2);t(pe),t(m);var he=s(m,2);{var Me=d=>{var re=_a(),fe=s(a(re));t(re),S(()=>v(fe,` ${e(Z)??""}`)),o(d,re)};j(he,d=>{e(Z)&&d(Me)})}var Ae=s(he,2);{var Pe=d=>{var re=ba(),fe=$e(re),Te=a(fe),Ue=s(a(Te),2),be=a(Ue,!0);t(Ue),t(Te);var $=s(Te,2),L=s(a($),2),V=a(L);t(L),t($);var n=s($,2),b=s(a(n),2),R=a(b);t(b),t(n);var M=s(n,2),p=s(a(M),2),u=a(p,!0);t(p),t(M);var D=s(M,2),l=s(a(D),2),E=a(l,!0);t(l),t(D),t(fe);var c=s(fe,2);{var y=q=>{var ie=pa(),ce=s(a(ie),2);Xe(ce,5,()=>e(g),Ze,(Oe,Be)=>{var we=ga(),Fe=a(we),Ge=a(Fe,!0);t(Fe);var Ce=s(Fe,2),De=a(Ce),We=a(De,!0);t(De),is(),t(Ce);var qe=s(Ce,2),Je=a(qe);t(qe),t(we),S(Ke=>{v(Ge,e(Be).payment_method||"Unknown"),v(We,e(Be).count),v(Je,`$${Ke??""}`)},[()=>(e(Be).total||0).toFixed(2)]),o(Oe,we)}),t(ce),t(ie),o(q,ie)};j(c,q=>{e(g)&&e(g).length>0&&q(y)})}var H=s(c,2),J=a(H),te=a(J);t(J);var K=s(J,2);{var X=q=>{var ie=ma(),ce=a(ie),Oe=s(a(ce));Xe(Oe,5,()=>e(ee),Ze,(Be,we)=>{var Fe=fa(),Ge=a(Fe),Ce=a(Ge,!0);t(Ge);var De=s(Ge),We=a(De),qe=a(We,!0);t(We),t(De);var Je=s(De),Ke=a(Je),cs=a(Ke,!0);t(Ke),t(Je);var de=s(Je),F=a(de);t(de);var ze=s(de),es=a(ze,!0);t(ze);var ds=s(ze),ss=a(ds,!0);t(ds);var rs=s(ds),bs=a(rs),xe=a(bs,!0);t(bs),t(rs),t(Fe),S((Ve,us,Ls)=>{v(Ce,Ve),v(qe,e(we).user_id),v(cs,e(we).listing_id),v(F,`$${us??""}`),v(es,e(we).currency),v(ss,e(we).payment_method||"N/A"),Ie(bs,1,`status-badge ${Ls??""}`,"svelte-p571ei"),v(xe,e(we).status||"completed")},[()=>Le(e(we).purchased_at),()=>e(we).amount_paid.toFixed(2),()=>(e(we).status||"completed").toLowerCase()]),o(Be,Fe)}),t(Oe),t(ce),t(ie),o(q,ie)},h=q=>{var ie=ha();o(q,ie)};j(K,q=>{e(ee).length>0?q(X):q(h,!1)})}t(H),S((q,ie)=>{v(be,e(N).total_transactions||0),v(V,`$${q??""}`),v(R,`$${ie??""}`),v(u,e(N).unique_users||0),v(E,e(N).unique_listings||0),v(te,`Recent Transactions (${e(ee).length??""})`)},[()=>(e(N).total_amount||0).toFixed(2),()=>(e(N).average_amount||0).toFixed(2)]),o(d,re)};j(Ae,d=>{e(N)&&e(ee)&&d(Pe)})}t(z),S(()=>{me.disabled=e(r),v(Se,e(r)?"ğŸ”„ Loading...":"ğŸ” Search"),ne.disabled=!e(ee)||e(ee).length===0}),Qe(B,()=>e(f).start_date,d=>as(f,e(f).start_date=d)),Qe(se,()=>e(f).end_date,d=>as(f,e(f).end_date=d)),hs(A,()=>e(f).payment_method,d=>as(f,e(f).payment_method=d)),hs(G,()=>e(f).status,d=>as(f,e(f).status=d)),Y("click",me,w),Y("click",ke,x),Y("click",ne,I),o(T,z),ns()}function Da(T,W){os(W,!1);const r=()=>gs(Ne,"$viewState",Z),[Z,ee]=_s();async function N(w,I="User"){try{const x=await Re("/Admin/GetUserById",{user_id:w});if(!x.success)throw new Error("Failed to load user");const z=x.user,m=await Re("/Admin/GetUserListings",{user_id:w}),C=m.success?m.listings:[],O=await Re("/Admin/GetUserPurchases",{user_id:w}),B=O.success?O.purchases:[],ae=await Re("/Admin/GetUserMessages",{user_id:w}),se=ae.success?ae.messages:[],P=await Re("/Admin/GetUserRatings",{user_id:w}),A=P.success?P.ratings:[],Q=await Re("/Admin/GetUserDevices",{user_id:w}),ve=Q.success?Q.devices:[];$s.set({currentUser:z,userListings:C,userPurchases:B,userMessages:se,userRatings:A,userDevices:ve}),Ne.update(ye=>({currentView:"user",breadcrumbs:[...ye.breadcrumbs,{type:"user",id:w,label:I}]}))}catch(x){console.error("Error loading user:",x)}}async function g(w,I="Listing"){try{const x=await Re("/Admin/GetListingById",{listingId:w});if(!x.success)throw new Error("Failed to load listing");const z=x.listing,m=await Re("/Admin/GetUserById",{user_id:z.user_id}),C=m.success?m.user:null,O=await Re("/Admin/GetListingPurchases",{listingId:w}),B=O.success?O.purchases:[],ae=await Re("/Admin/GetListingMessages",{listingId:w}),se=ae.success?ae.messages:[];Ns.set({currentListing:z,listingPurchases:B,listingMessages:se,listingOwner:C}),Ne.update(P=>({currentView:"listing",breadcrumbs:[...P.breadcrumbs,{type:"listing",id:w,label:I}]}))}catch(x){console.error("Error loading listing:",x)}}async function f(w,I="Transaction"){try{const x=await Re("/Admin/GetTransactionById",{transactionId:w});if(!x.success)throw new Error("Failed to load transaction");const z=x.transaction,m=await Re("/Admin/GetUserById",{user_id:z.user_id}),C=m.success?m.user:null,O=await Re("/Admin/GetListingById",{listingId:z.listing_id});let B=null,ae=null;if(O.success){ae=O.listing;const se=await Re("/Admin/GetUserById",{user_id:O.listing.user_id});B=se.success?se.user:null}Ps.set({currentTransaction:z,transactionBuyer:C,transactionSeller:B,transactionListing:ae}),Ne.update(se=>({currentView:"transaction",breadcrumbs:[...se.breadcrumbs,{type:"transaction",id:w,label:I}]}))}catch(x){console.error("Error loading transaction:",x)}}ls(),Zs(T,{children:(w,I)=>{var x=Ee(),z=$e(x);{var m=O=>{lt(O,{viewUser:N,viewListing:g,viewTransaction:f})},C=O=>{var B=Ee(),ae=$e(B);{var se=A=>{Tt(A,{viewListing:g,viewTransaction:f})},P=A=>{var Q=Ee(),ve=$e(Q);{var ye=U=>{Mt(U,{viewUser:N,viewTransaction:f})},ge=U=>{var G=Ee(),ue=$e(G);{var _e=oe=>{Ct(oe,{viewUser:N,viewListing:g})},je=oe=>{var pe=Ee(),me=$e(pe);{var Se=ne=>{ra(ne,{})},ke=ne=>{var he=Ee(),Me=$e(he);{var Ae=d=>{ua(d,{})},Pe=d=>{var re=Ee(),fe=$e(re);{var Te=Ue=>{ka(Ue,{})};j(fe,Ue=>{r().currentView==="payment-reports"&&Ue(Te)},!0)}o(d,re)};j(Me,d=>{r().currentView==="logs"?d(Ae):d(Pe,!1)},!0)}o(ne,he)};j(me,ne=>{r().currentView==="apn-message"?ne(Se):ne(ke,!1)},!0)}o(oe,pe)};j(ue,oe=>{r().currentView==="transaction"?oe(_e):oe(je,!1)},!0)}o(U,G)};j(ve,U=>{r().currentView==="listing"?U(ye):U(ge,!1)},!0)}o(A,Q)};j(ae,A=>{r().currentView==="user"?A(se):A(P,!1)},!0)}o(O,B)};j(z,O=>{r().currentView==="search"?O(m):O(C,!1)})}o(w,x)},$$slots:{default:!0}}),ns(),ee()}export{Da as component};
